@using TheContactBookApplication.Models;
@using TheContactBookApplication.Services;

@inject IContactsInfoProvider contactsInfoProvider;

<div class="contacts-container">

    <Contact />

    @if (Contacts != null)
    {
        @foreach (var contact in Contacts)
        {
            <Contact ContactModel="contact" ContactsChanged="ReloadContactList" />
        }
    }

    @if(WantToAdd == true)
    {
        <Contact WantAddContact="@WantToAdd" ContactsChanged="ReloadContactList" />
    }

    <AddContactButton WantToAddChanged="@GetWantToAddValue"/>



</div>

@code {

    public List<ContactModel>? Contacts { get; set; }

    public bool WantToAdd { get; set; } = false;

    protected override async Task OnInitializedAsync()
    {
        await LoadDataAsync();
    }

    public async Task LoadDataAsync()
    {
        Contacts = await contactsInfoProvider.GetContactsInfoAsync();
    }

    public void GetWantToAddValue(bool wantToAdd)
    {
        WantToAdd = wantToAdd;
    }

    public async Task ReloadContactList()
    {
        WantToAdd = false;
        await LoadDataAsync();
    }
}
